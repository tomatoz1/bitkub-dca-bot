name: DCA Bot

on:
  # -------------------------------------------------------
  # SCHEDULE: Uncomment ONE of the lines below to choose frequency
  # -------------------------------------------------------
  schedule:
    # OPTION 1: DAILY at 09:00 AM Bangkok Time (02:00 UTC)
    - cron: '0 2 * * *'

    # OPTION 2: WEEKLY on Monday at 09:00 AM BKK
    # - cron: '0 2 * * 1'

    # OPTION 3: HOURLY (At the top of every hour)
    # - cron: '0 * * * *'

    # OPTION 4: EVERY 12 HOURS (09:00 AM and 09:00 PM BKK)
    # - cron: '0 2,14 * * *'

    # OPTION 5: EVERY 10 MINUTES <-- CURRENT
    # - cron: '*/10 * * * *'

  # -------------------------------------------------------
  # MANUAL TRIGGER: Allows you to run this on demand
  # -------------------------------------------------------
  workflow_dispatch:

jobs:
  trade:
    runs-on: ubuntu-latest
    environment: production
    steps:
      - name: Checkout Repo
        uses: actions/checkout@v4

      - name: Setup Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.10'

      - name: Install Dependencies
        run: pip install requests

      - name: Run Trading Bot
        env:
          API_KEY: ${{ secrets.API_KEY }}
          API_SECRET: ${{ secrets.API_SECRET }}
          
          # LOGIC: Use Repo Variable, otherwise use Default '108'
          BUY_AMOUNT: ${{ vars.BUY_AMOUNT || '108' }}
          
          # LOGIC: Use Repo Variable, otherwise use Default 'BTC_THB'
          SYMBOL: ${{ vars.SYMBOL || 'BTC_THB' }}
        
        run: python main.py